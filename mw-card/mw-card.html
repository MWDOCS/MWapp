<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <link rel="stylesheet" href="https://cdn.staticfile.net/picocss/2.0.0-rc2/pico.min.css" />
    <link rel="icon" href="https://mwdocs.info/favicon.ico">
    <title>MW & MWT 文档丨资料卡生成</title>
    <style>
        .avatar {
            border-radius: 25% 10%;
            width: 120px;
        }

        .level.is-mobile .level-left,
        .level.is-mobile .level-right {
            display: flex;
        }

        .level.is-mobile .level-item:not(:last-child) {
            margin-bottom: 0;
            margin-right: 0.75rem;
        }

        .article-licensing {
            position: relative;
            z-index: 1;
            background: #f5f5f5;
            overflow: hidden;
        }

        .article-licensing:after {
            position: absolute;
            z-index: -1;
            right: -320px;
            top: -200px;
            content: url('mw.png');
            opacity: 0.1;
        }
    </style>
</head>

<body>
    <main class="container">
        <hgroup>
            <h2>现代战舰资料卡生成</h2>
            <p>*由 MW & MWT 文档 提供支持</p>
        </hgroup>
        <a href="./index.html" role="button" class="outline">返回重做</a>
        <a href="javascript:savePicture()" role="button" class="outline">生成图片并下载</a>
    </main>
    <div class="container">
        <main id="main">
            <article class="article-licensing">
                <div class="licensing-title">
                    <div id="avatar"></div>
                </div>
                <br />
                <div class="licensing-meta level is-mobile">
                    <div class="level-left">
                        <div class="level-item is-narrow">
                            <div>
                                <h5>游戏昵称</h5>
                                <b id="name"></b>
                            </div>
                        </div>
                        <div class="level-item is-narrow">
                            <div>
                                <h5>游戏头衔</h5>
                                <p id="title"></p>
                            </div>
                        </div>
                        <div class="level-item is-narrow">
                            <div>
                                <h5>游戏ID</h5>
                                <b id="gameid"></b>
                            </div>
                        </div>
                    </div>
                    <font color="#646B79"><b id="about"></b></font>
                </div>
                <footer>
                    <hgroup>
                        <h3>现代战舰资料卡生成</h3>
                        <p><b>网站地址：https://mwapp.mwdocs.info/mw-card/</b></p>
                    </hgroup>
                </footer>
            </article>
        </main>
    </div>
    <a id="download" download target="_blank" rel="noreferrer" style="display: none;"></a>
</body>
<script type="text/javascript" src="./html2canvas.min.js"></script>
<script>
    const Avatar = [
        '',
        '<img class="avatar" src="./Avatar/AvatarPortrait_AlfaTesters_Widget.png" />',
        '<img class="avatar" src="./Avatar/AvatarPortrait_CloseBetaTest_Widget.png" />',
        '<img class="avatar" src="./Avatar/AvatarPortrait_CommunityTournament_Winner_Widget.png" />',
        '<img class="avatar" src="./Avatar/AvatarPortrait_DrawingCompetitionWinner_Widget.png" />',
        '<img class="avatar" src="./Avatar/AvatarPortrait_GameModerators_Widget.png" />',
        '<img class="avatar" src="./Avatar/AvatarPortrait_GodofFortuneLNY24_Widget.png" />',
        '<img class="avatar" src="./Avatar/AvatarPortrait_GoldHunt_Common_Widget.png" />',
        '<img class="avatar" src="./Avatar/AvatarPortrait_Hacker_Widget.png" />',
        '<img class="avatar" src="./Avatar/AvatarPortrait_MWPress_Widget.png" />',
    ]
    const Title = [
        '<b>啥也不是</b>',
        '<b><font color="#0f59a4">舞蹈之心</font></b>',
        '<b><font color="#f9bd10">英雄</font></b>',
        '<b><font color="#f9bd10">禄星</font></b>',
        '<b><font color="#f9bd10">食心人</font></b>',
        '<b><font color="#f9bd10">糖果之王</font></b>',
        '<b><font color="#f9bd10">派对大亨</font></b>',
        '<b><font color="#f9bd10">冬季冠军</font></b>',
        '<b><font color="#2e317c">传奇</font></b>',
        '<b><font color="#2e317c">神枪手</font></b>',
        '<b><font color="#2e317c">财神爷</font></b>',
        '<b><font color="#2e317c">奖牌得主</font></b>',
        '<b><font color="#2e317c">冰霜狂欢</font></b>',
        '<b><font color="#2e317c">滑雪能手</font></b>',
        '<b><font color="#2e317c">年兽防御者</font></b>',
        '<b><font color="#2e317c">圣诞老人助手</font></b>'
    ]
    class Profile {
        constructor(avatar, name, title, gameid, about) {
            this.avatar = Avatar[avatar]
            this.name = name
            this.title = Title[title]
            this.gameid = gameid
            this.about = about
        }
    }
    function showResult(profile) {
        console.log(profile)
        document.querySelector("#avatar").innerHTML = profile.avatar
        document.querySelector("#name").innerText = profile.name
        document.querySelector("#title").innerHTML = profile.title
        document.querySelector("#gameid").innerText = profile.gameid
        document.querySelector("#about").innerText = profile.about
    }
    function tryGetParam(params, prop) {
        if (params.has(prop)) {
            return params.get(prop)
        }
        return ""
    }
    async function savePicture() {
        await html2canvas(document.querySelector("#main"), { scale: 2 }).then(
            async function (canvas) {
                canvas = canvas.toDataURL("image/png", 1);
                console.log(canvas);
                document.getElementById("download").setAttribute("href", canvas);
                document.getElementById("download").click();
            }
        );
    }
    const urlParams = new URL(window.location.href).searchParams
    let prof = new Profile(
        tryGetParam(urlParams, 'avatar'),
        tryGetParam(urlParams, 'name'),
        tryGetParam(urlParams, 'title'),
        tryGetParam(urlParams, 'gameid'),
        tryGetParam(urlParams, 'about'),
    )
    showResult(prof)
</script>

</html>